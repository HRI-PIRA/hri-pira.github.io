!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){const n={low_activity_lying:.45,low_activity:.54,singing:.65,mid_activity:.9,sports:1.2,test_1:.54,test_2:.65};function a(e){return"singing"==e?3500:"test_2"==e?2500:100}function o(e){const t=2.7618*(Math.exp(1.1761*3.35)-1),o=a("low_activity");return t*(a(e)/o)*(n[e]/n.low_activity)}function l(e,t,n,a){let o=390625*t+225625;return o*=Math.exp(t*a),o-=225625,o*=Math.exp(-t*a-.5776*a),o=390625*t-o,o*=e,o/(n*(225625*t+130321))}function i(e,t,a,i){0==t&&(t+=.01),console.log(`Calculating pira for: t=${e}, Q=${t}, activity=${a}, V=${i}`);const u=function(e,t){return e/t}(i,t),r=o(a),d=function(e,t){return e*Math.exp(-.5776*t)}(r,u),c=function(e,t){return t/e}(i,t);if(e>u){const o=l(r,c,t,u),i=function(e,t,n,a,o){return e*Math.exp(-t*(o+n))*(t*(o-n)*Math.exp(t*(o+n))-Math.exp(t*o)+Math.exp(t*n))/(a*t)}(d,c,u,t,e);return 1-Math.exp(-(o+i)*n[a])}{const o=l(r,c,t,e);return 1-Math.exp(-o*n[a])}}e.exports={prepareData:function(e,t,n,a){const o=e;let l=[],u=[],r=[],d=3e3;150*a>d&&(d=150*a);for(let e=50;e<=d;e+=50){l=[];let n=[];for(let a=0;a<=6;a+=.1)p=i(a,e,t,o),p=Math.round(1e4*p)/100,n.push(p),l.push(a);u.push(e),r.push(n)}return{test:l,x:l,y:u,z:r}},prepareDataSimple:function(e,t,n,a){const o=e;console.log("Total airflow for all people in the room is (Q) is "+n);let l=[],u=[],r=[],d=[];for(let e=0;e<=6;e+=1){p=i(e,n,t,o),p=Math.round(1e4*p)/100,u.push(p),l.push(e),r.push(e),d.push(Math.round(p*a/100));for(let a=.1;a<1;a+=.1)p=i(e+a,n,t,o),p=Math.round(1e4*p)/100,u.push(p),l.push(e+a)}return[{x:l,y:u},{x:r,y:d}]},pira:i,f_qa:o,f_Q:function(e){return"very_bad"==e?10:"bad"==e?20:"ok"==e?30:"good"==e?40:"very_good"==e?60:void 0}}},function(e,t,n){const a=n(0).prepareData,o=n(0).prepareDataSimple,l=n(0).f_Q;var i=document.getElementById("volume").value,u=document.getElementById("activity").value,r=document.getElementById("mode").value,d=document.getElementById("airing").value,c=document.getElementById("people").value,s=-1;m();const p=document.getElementById("chart");function m(){s=l(d)*c,document.getElementById("usedQ").value=s}function g(){console.log("The graph must be updated!"),console.log(`Volume: ${i}, activity: ${u}, airing: ${d}`),"simple"===r?(data=o(i,u,s,c),function(e){e[0].mode="lines",e[0].name="PIRA (in %)",e[0].yaxis="y",e[1].type="bar",e[1].yaxis="y2",e[1].name="Potentiell Angesteckte",console.log(e);var t={shareX:!0,xaxis:{title:{text:"Zeit in Stunden"}},yaxis:{title:"PIRA (in %)",overlaying:"y2",tickvals:[10,20,30,40,50,60,70,80,90,100],range:[0,100]},yaxis2:{tickmode:"auto",title:"Anzahl sich potentiell angesteckter Personen (gerundet)",side:"right",range:[0,c]},legend:{y:1,x:0}};Plotly.newPlot(p,e,t,{responsive:!0})}(data)):"expert"===r&&(data=a(i,u,d,c),function(e){e.type="contour",e.colorbar={title:"PIRA",ticksuffix:"%"},e.hovertemplate="PIRA: %{z:.2f}%<extra></extra>";console.log(e),Plotly.newPlot(p,[e],{showaxeslabels:!0,xaxis_title:"Zeit in Stunden",xaxis:{title:{text:"Zeit in Stunden"}},yaxis:{title:{text:"Volumenstrom in mÂ³/h"}}},{responsive:!0})}(data))}e.exports={modeUpdated:function(e){r=e,g()},volumeUpdated:function(e){i=e,g()},activityUpdated:function(e){u=e,g()},airingUpdated:function(e){d=e,m(),g()},vistypeUpdated:function(e){vistype=e,g()},peopleUpdated:function(e){c=e,m(),g()},usedQUpdated:function(e){s=e,g()}}},function(e,t,n){n(3);const a=n(1);document.getElementById("mode").addEventListener("input",(function(e){if("expert"==e.target.value){for(el of(simpelElements=document.getElementsByClassName("simple"),simpelElements))el.style.display="none";for(el of(expertElements=document.getElementsByClassName("expert"),expertElements))el.style.display="block"}else if("simple"==e.target.value){for(el of(expertElements=document.getElementsByClassName("simple"),expertElements))el.style.display="block";for(el of(expertElements=document.getElementsByClassName("expert"),expertElements))el.style.display="none"}a.modeUpdated(e.target.value)})),document.getElementById("activity").addEventListener("input",(function(e){a.activityUpdated(e.target.value)})),document.getElementById("people").addEventListener("input",(function(e){""!=e.target.value&&(amount=e.target.value,(1>amount||amount>100)&&(amount=3,e.target.value=amount),a.peopleUpdated(amount))})),document.getElementById("airing").addEventListener("change",(function(e){a.airingUpdated(e.target.value)})),document.getElementById("usedQ").addEventListener("change",(function(e){e.target.value<1?e.target.value=1:e.target.value>3e3&&(e.target.value=3e3),a.usedQUpdated(e.target.value)}))},function(e,t,n){const a=n(1);function o(e,t){this.data=t,this.element=e,e.value=t,e.addEventListener("change",this,!1)}function l(){i.data>10&&i.change(10),i.data<1&&i.change(1),u.data>10&&i.change(10),u.data<1&&i.change(1),r.data>5&&i.change(5),r.data<1&&i.change(1);const e=i.data*u.data*r.data;return console.log(e),document.getElementById("volume").value=e,a.volumeUpdated(e),e}o.prototype.handleEvent=function(e){switch(e.type){case"change":this.change(this.element.value),l()}},o.prototype.change=function(e){this.data=e,this.element.value=e};var i=new o(document.getElementById("length"),document.getElementById("length").value),u=new o(document.getElementById("width"),document.getElementById("width").value),r=new o(document.getElementById("height"),document.getElementById("height").value);l(),e.exports={get:l,init:l}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RhdGEuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dyYXBoLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdm9sdW1lLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiUWIiLCJsb3dfYWN0aXZpdHlfbHlpbmciLCJsb3dfYWN0aXZpdHkiLCJzaW5naW5nIiwibWlkX2FjdGl2aXR5Iiwic3BvcnRzIiwidGVzdF8xIiwidGVzdF8yIiwiZl9FIiwiYWN0aXZpdHkiLCJmX3FhIiwicV8wIiwiTWF0aCIsImV4cCIsIkVfMCIsImZfQyIsInFhIiwiQUNIIiwiUSIsInBpcmEiLCJWIiwiY29uc29sZSIsImxvZyIsInRhdSIsImZfdGF1IiwicWF0YXUiLCJmX3FhdGF1IiwiZl9BQ0giLCJDIiwiQ3RhdSIsImZfQ3RhdSIsInByZXBhcmVEYXRhIiwidm9sdW1lIiwiYWlyIiwicGVvcGxlIiwieEEiLCJ5QSIsInJvd3MiLCJtYXgiLCJyb3ciLCJyb3VuZCIsInB1c2giLCJ0ZXN0IiwieCIsInkiLCJ6IiwicHJlcGFyZURhdGFTaW1wbGUiLCJ4MiIsInkyIiwic3QiLCJmX1EiLCJhaXJpbmciLCJkYXRhRiIsImRhdGFGU2ltcGxlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInVzZWRRIiwiY2FsY3VsYXRlVXNlZFEiLCJjaGFydERpdiIsInVwZGF0ZUdyYXBoIiwiZGF0YSIsInlheGlzIiwidHlwZSIsImxheW91dCIsInNoYXJlWCIsInhheGlzIiwidGl0bGUiLCJ0ZXh0Iiwib3ZlcmxheWluZyIsInRpY2t2YWxzIiwicmFuZ2UiLCJ5YXhpczIiLCJ0aWNrbW9kZSIsInNpZGUiLCJsZWdlbmQiLCJQbG90bHkiLCJuZXdQbG90IiwicmVzcG9uc2l2ZSIsImRyYXdTaW1wbGVQbG90IiwiY29sb3JiYXIiLCJ0aWNrc3VmZml4IiwiaG92ZXJ0ZW1wbGF0ZSIsInNob3dheGVzbGFiZWxzIiwieGF4aXNfdGl0bGUiLCJkcmF3Q29udG91clBsb3QiLCJtb2RlVXBkYXRlZCIsIm5ld01vZGUiLCJ2b2x1bWVVcGRhdGVkIiwibmV3Vm9sdW1lIiwiYWN0aXZpdHlVcGRhdGVkIiwibmV3QWN0aXZpdHkiLCJhaXJpbmdVcGRhdGVkIiwibmV3QWlyaW5nIiwidmlzdHlwZVVwZGF0ZWQiLCJuZXdWaXNUeXBlIiwidmlzdHlwZSIsInBlb3BsZVVwZGF0ZWQiLCJuZXdQZW9wbGUiLCJ1c2VkUVVwZGF0ZWQiLCJuZXdVc2VkUSIsImdyYXBoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwidGFyZ2V0IiwiZWwiLCJzaW1wZWxFbGVtZW50cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJzdHlsZSIsImRpc3BsYXkiLCJleHBlcnRFbGVtZW50cyIsImFtb3VudCIsIklucHV0RWxlbWVudCIsImVsZW1lbnQiLCJ0aGlzIiwidXBkYXRlVm9sdW1lIiwibGVuZ3RoRWxlbWVudCIsImNoYW5nZSIsIndpZHRoRWxlbWVudCIsImhlaWdodEVsZW1lbnQiLCJoYW5kbGVFdmVudCIsImluaXQiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUs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LFNBQVN0RSxPQUUvQnFJLEVBQWdCLElBQUlQLEVBQ3RCekQsU0FBU0MsZUFBZSxVQUN4QkQsU0FBU0MsZUFBZSxVQUFVdEUsT0FFcENpSSxJQUVBbkosRUFBT0QsUUFBVSxDQUNmZSxJQUFLcUksRUFDTE0sS0FBTU4iLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDIpO1xuIiwiY29uc3QgUWIgPSB7XG4gIGxvd19hY3Rpdml0eV9seWluZzogMC40NSxcbiAgbG93X2FjdGl2aXR5OiAwLjU0LFxuICBzaW5naW5nOiAwLjY1LFxuICBtaWRfYWN0aXZpdHk6IDAuOSxcbiAgc3BvcnRzOiAxLjIsXG4gIHRlc3RfMTogMC41NCwgLy8gdmFsdWUgdXNlZCBpbiB0ZXN0X2RhdGEvUElSX01vZGVsbC5qcGdcbiAgdGVzdF8yOiAwLjY1LCAvLyB2YWx1ZSB1c2VkIGluIHRlc3RfZGF0YS9QSVJfTW9kZWxsX2FrdC5qcGcgYXMgaW5zdHJ1Y3RlZCBieSBtYWlsXG59O1xuXG5mdW5jdGlvbiBmX3RhdShWLCBRKSB7XG4gIHJldHVybiBWIC8gUTtcbn1cblxuZnVuY3Rpb24gZl9FKGFjdGl2aXR5KSB7XG4gIGlmIChhY3Rpdml0eSA9PSBcInNpbmdpbmdcIikge1xuICAgIHJldHVybiAzNTAwO1xuICB9IGVsc2UgaWYgKGFjdGl2aXR5ID09XCJ0ZXN0XzJcIikge1xuICAgIHJldHVybiAyNTAwOyAvLyB2YWx1ZSByZWNlaXZlZCB2aWEgbWFpbCBmcm9tIGtyaWVnZWxcbiAgfSBlbHNlIHJldHVybiAxMDA7XG59XG5cbmZ1bmN0aW9uIGZfUShhaXJpbmcpIHtcbiAgaWYgKGFpcmluZyA9PSBcInZlcnlfYmFkXCIpIHtcbiAgICByZXR1cm4gMTA7XG4gIH0gZWxzZSBpZiAoYWlyaW5nID09IFwiYmFkXCIpIHtcbiAgICByZXR1cm4gMjA7XG4gIH0gZWxzZSBpZiAoYWlyaW5nID09IFwib2tcIikge1xuICAgIHJldHVybiAzMDtcbiAgfSBlbHNlIGlmIChhaXJpbmcgPT0gXCJnb29kXCIpIHtcbiAgICByZXR1cm4gNDA7XG4gIH0gZWxzZSBpZiAoYWlyaW5nID09IFwidmVyeV9nb29kXCIpIHtcbiAgICByZXR1cm4gNjA7XG4gIH1cbn1cblxuZnVuY3Rpb24gZl9xYShhY3Rpdml0eSkge1xuICBjb25zdCBSXzAgPSAzLjM1O1xuICBjb25zdCBxXzAgPSAyLjc2MTggKiAoTWF0aC5leHAoMS4xNzYxICogUl8wKSAtIDEpO1xuXG4gIGNvbnN0IEVfMCA9IGZfRShcImxvd19hY3Rpdml0eVwiKTtcbiAgY29uc3QgRSA9IGZfRShhY3Rpdml0eSk7XG5cbiAgcmV0dXJuIHFfMCAqIChFIC8gRV8wKSAqIChRYlthY3Rpdml0eV0gLyBRYi5sb3dfYWN0aXZpdHkpO1xufVxuXG5mdW5jdGlvbiBmX3FhdGF1KHFhLCB0YXUpIHtcbiAgcmV0dXJuIHFhICogTWF0aC5leHAoLTAuNTc3NiAqIHRhdSk7XG59XG5cbmZ1bmN0aW9uIGZfQUNIKFYsIFEpIHtcbiAgcmV0dXJuIFEgLyBWO1xufVxuXG5mdW5jdGlvbiBmX0MocWEsIEFDSCwgUSwgdCkge1xuICAvLyBudW1lcmF0b3JcblxuICBsZXQgbiA9IDM5MDYyNSAqIEFDSCArIDIyNTYyNTtcbiAgLy8gY29uc29sZS5sb2cobik7XG4gIG4gPSBuICogTWF0aC5leHAoQUNIICogdCk7XG4gIC8vIGNvbnNvbGUubG9nKG4pO1xuICBuID0gbiAtIDIyNTYyNTtcbiAgLy8gY29uc29sZS5sb2cobik7XG4gIG4gPSBuICogTWF0aC5leHAoLUFDSCAqIHQgLSAoMzYxIC8gNjI1KSAqIHQpO1xuICAvLyBjb25zb2xlLmxvZyhuKTtcbiAgbiA9IDM5MDYyNSAqIEFDSCAtIG47XG4gIC8vIGNvbnNvbGUubG9nKG4pO1xuICBuID0gcWEgKiBuO1xuXG4gIC8vIGNvbnNvbGUubG9nKG4pO1xuICAvLyBjb25zb2xlLmxvZyhxYSk7XG4gIC8vIGNvbnNvbGUubG9nKEFDSCk7XG4gIC8vIGNvbnNvbGUubG9nKFEpO1xuICAvLyBjb25zb2xlLmxvZyhcInQ6IFwiICsgdCk7XG5cbiAgLy8gY29uc29sZS5sb2cobik7XG4gIC8vIGRlbm9taW5hdG9yXG4gIGxldCBkID0gUSAqICgyMjU2MjUgKiBBQ0ggKyAxMzAzMjEpO1xuICAvLyBjb25zb2xlLmxvZyhkKTtcblxuICByZXR1cm4gbiAvIGQ7XG59XG5cbmZ1bmN0aW9uIGZfQ3RhdShxYXRhdSwgQUNILCB0YXUsIFEsIHQpIHtcbiAgLy8gbnVtZXJhdG9yXG4gIGxldCBuID1cbiAgICBxYXRhdSAqXG4gICAgTWF0aC5leHAoLUFDSCAqICh0ICsgdGF1KSkgKlxuICAgIChBQ0ggKiAodCAtIHRhdSkgKiBNYXRoLmV4cChBQ0ggKiAodCArIHRhdSkpIC1cbiAgICAgIE1hdGguZXhwKEFDSCAqIHQpICtcbiAgICAgIE1hdGguZXhwKEFDSCAqIHRhdSkpO1xuXG4gIC8vIGRlbm9taW5hdG9yXG4gIGxldCBkID0gUSAqIEFDSDtcblxuICByZXR1cm4gbiAvIGQ7XG59XG5cbmZ1bmN0aW9uIHBpcmEodCwgUSwgYWN0aXZpdHksIFYpIHtcbiAgaWYgKFEgPT0gMCkgUSArPSAwLjAxO1xuICBjb25zb2xlLmxvZyhgQ2FsY3VsYXRpbmcgcGlyYSBmb3I6IHQ9JHt0fSwgUT0ke1F9LCBhY3Rpdml0eT0ke2FjdGl2aXR5fSwgVj0ke1Z9YCk7XG4gIGNvbnN0IHRhdSA9IGZfdGF1KFYsIFEpO1xuICAvLyBjb25zb2xlLmxvZyhcInRhdTogXCIgKyB0YXUpO1xuICBjb25zdCBxYSA9IGZfcWEoYWN0aXZpdHkpO1xuICAvLyBjb25zb2xlLmxvZyhcInFhOiBcIiArIHFhKTtcbiAgY29uc3QgcWF0YXUgPSBmX3FhdGF1KHFhLCB0YXUpO1xuICAvLyBjb25zb2xlLmxvZyhcInFhdGF1OiBcIiArIHFhdGF1KTtcbiAgY29uc3QgQUNIID0gZl9BQ0goViwgUSk7XG4gIC8vIGNvbnNvbGUubG9nKFwiQUNIOiBcIiArIEFDSCk7XG4gIC8vIGNvbnNvbGUubG9nKFwiUWI6IFwiICsgUWJbYWN0aXZpdHldKTtcblxuICBpZiAodCA+IHRhdSkge1xuICAgIGNvbnN0IEMgPSBmX0MocWEsIEFDSCwgUSwgdGF1KTtcbiAgICAvLyBjb25zb2xlLmxvZyhDKTtcbiAgICBjb25zdCBDdGF1ID0gZl9DdGF1KHFhdGF1LCBBQ0gsIHRhdSwgUSwgdCk7XG4gICAgLy8gY29uc29sZS5sb2coQ3RhdSk7XG4gICAgcmV0dXJuIDEgLSBNYXRoLmV4cCgtKEMgKyBDdGF1KSAqIFFiW2FjdGl2aXR5XSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgQyA9IGZfQyhxYSwgQUNILCBRLCB0KTtcbiAgICAvLyBjb25zb2xlLmxvZyhDKTtcbiAgICByZXR1cm4gMSAtIE1hdGguZXhwKC1DICogUWJbYWN0aXZpdHldKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwcmVwYXJlRGF0YSh2b2x1bWUsIGFjdGl2aXR5LCBhaXIsIHBlb3BsZSkge1xuICBjb25zdCBWID0gdm9sdW1lO1xuXG4gIGxldCB4QSA9IFtdO1xuICBsZXQgeUEgPSBbXTtcbiAgbGV0IHJvd3MgPSBbXTtcblxuICBsZXQgbWluID0gNTBcbiAgbGV0IG1heCA9IDMwMDBcbiAgXG4gIGlmICgxNTAgKiBwZW9wbGUgPiBtYXgpIHtcbiAgICAgIG1heCA9IDE1MCAqIHBlb3BsZVxuICB9XG5cbiAgZm9yIChsZXQgUSA9IG1pbjsgUSA8PSBtYXg7IFEgKz0gNTApIHtcbiAgICB4QSA9IFtdO1xuICAgIGxldCByb3cgPSBbXTtcblxuICAgIGZvciAobGV0IHQgPSAwLjA7IHQgPD0gNi4wOyB0ICs9IDAuMSkge1xuICAgICAgLy8gaG91cnMsKyBpbmNyZW1lbnRzIGluIGhvdXJzXG4gICAgICBwID0gcGlyYSh0LCBRLCBhY3Rpdml0eSwgVik7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiUGlyYSBmb3IgdD1cIiArIHQgKyBcIiwgUT1cIiArIFEgKyBcIjogXCIgKyBwKTtcbiAgICAgIHAgPSBNYXRoLnJvdW5kKHAgKiAxMDAwMCkgLyAxMDA7XG4gICAgICAvL2lmICh0ID09IDYgJiYgUSA9PSA1MDApIHAgPSAxMDA7XG4gICAgLy8gICBpZiAoaXNOYU4ocCkgfHwgcCA+PSAxMDApIHtcbiAgICAvLyAgICAgICBwID0gMFxuICAgIC8vICAgfVxuICAgICAgcm93LnB1c2gocCk7XG4gICAgICB4QS5wdXNoKHQpO1xuICAgIH1cbiAgICB5QS5wdXNoKFEpO1xuICAgIHJvd3MucHVzaChyb3cpO1xuICB9XG5cbiAgLy8gZm9yIChsZXQgbWludXRlID0gMDsgbWludXRlIDw9IDM2MDsgbWludXRlICs9IDMwKSB7XG4gIC8vICAgICBsZXQgdCA9IG1pbnV0ZSAvIDYwO1xuICAvLyAgICAgbGV0IG0gPSBtaW51dGUgJSA2MDtcbiAgLy8gICAgIGxldCBoID0gKG1pbnV0ZSAtIG0pIC8gNjA7XG4gIC8vICAgICBsZXQgdGltZSA9IGggKyBcIjpcIiArIG0gKyBcImhcIjtcbiAgLy8gfVxuXG4gIHJldHVybiB7XG4gICAgdGVzdDogeEEsXG4gICAgeDogeEEsXG4gICAgeTogeUEsXG4gICAgejogcm93cyxcbiAgfTtcbn1cblxuZnVuY3Rpb24gcHJlcGFyZURhdGFTaW1wbGUodm9sdW1lLCBhY3Rpdml0eSwgUSwgcGVvcGxlKSB7XG4gIGNvbnN0IFYgPSB2b2x1bWU7XG4gXG4gIGNvbnNvbGUubG9nKGBUb3RhbCBhaXJmbG93IGZvciBhbGwgcGVvcGxlIGluIHRoZSByb29tIGlzIChRKSBpcyAke1F9YClcblxuICBsZXQgeCA9IFtdO1xuICBsZXQgeSA9IFtdOyAvLyBwaXJhXG4gIGxldCB4MiA9IFtdOyAvLyBvbmx5IHRpbWVzdGFtcHMgZm9yIHRoZSBmdWxsIGhvdXJcbiAgbGV0IHkyID0gW107IC8vIGluZmVjdGVkIHBlb3BsZVxuXG4gIGZvciAobGV0IHQgPSAwOyB0IDw9IDY7IHQgKz0gMSkge1xuICAgIHAgPSBwaXJhKHQsIFEsIGFjdGl2aXR5LCBWKTtcbiAgICBwID0gTWF0aC5yb3VuZChwICogMTAwMDApIC8gMTAwO1xuICAgIHkucHVzaChwKTtcbiAgICB4LnB1c2godCk7XG4gICAgeDIucHVzaCh0KVxuICAgIHkyLnB1c2goTWF0aC5yb3VuZChwICogcGVvcGxlIC8gMTAwKSk7XG4gICAgLy8gaW50ZXJtZWRpYXRlIHN0ZXBzIGZvciBwaXJhIG9ubHksIG5vdCBmb3Igbm8uIGluZmVjdGVkIHBlb3BsZVxuICAgIGZvciAobGV0IHN0ID0gMC4xOyBzdCA8IDE7IHN0ICs9IDAuMSkge1xuICAgICAgICBwID0gcGlyYSh0ICsgc3QsIFEsIGFjdGl2aXR5LCBWKTtcbiAgICAgICAgcCA9IE1hdGgucm91bmQocCAqIDEwMDAwKSAvIDEwMDtcbiAgICAgICAgeS5wdXNoKHApO1xuICAgICAgICB4LnB1c2godCArIHN0KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gW1xuICAgIHtcbiAgICAgIHg6IHgsXG4gICAgICB5OiB5XG4gICAgfSxcbiAgICB7XG4gICAgICB4OiB4MixcbiAgICAgIHk6IHkyXG4gICAgfVxuICBdO1xuXG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIHByZXBhcmVEYXRhOiBwcmVwYXJlRGF0YSxcbiAgICBwcmVwYXJlRGF0YVNpbXBsZTogcHJlcGFyZURhdGFTaW1wbGUsXG4gICAgcGlyYTogcGlyYSxcbiAgICBmX3FhOiBmX3FhLFxuICAgIGZfUTogZl9RXG59XG4iLCJjb25zdCBkYXRhRiA9IHJlcXVpcmUoXCIuL2RhdGEuanNcIikucHJlcGFyZURhdGE7XG5jb25zdCBkYXRhRlNpbXBsZSA9IHJlcXVpcmUoXCIuL2RhdGEuanNcIikucHJlcGFyZURhdGFTaW1wbGU7XG5jb25zdCBmX1EgPSByZXF1aXJlKFwiLi9kYXRhLmpzXCIpLmZfUTtcbi8vIGNvbnN0IFBsb3RseSA9IHJlcXVpcmUoXCJwbG90bHkuanMtZ2wzZC1kaXN0LW1pblwiKSAvLyBub3QgaW5zdGFsbGVkIHZpYSBucG0gdG8gcmVkdWNlIGJ1bmRsZSBzaXplXG5cbnZhciB2b2x1bWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZvbHVtZVwiKS52YWx1ZTtcbnZhciBhY3Rpdml0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWN0aXZpdHlcIikudmFsdWU7XG4vLyB2YXIgdmlzdHlwZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlzdHlwZVwiKS52YWx1ZTtcbnZhciBtb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RlXCIpLnZhbHVlOyAvLyBzaW1wbGUgb3IgZXhwZXJ0XG52YXIgYWlyaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhaXJpbmdcIikudmFsdWU7IC8vIGluIHRoZSBmb3JtdWxhLCB0aGlzIGlzIFFcbnZhciBwZW9wbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBlb3BsZVwiKS52YWx1ZTtcbnZhciB1c2VkUSA9IC0xO1xuY2FsY3VsYXRlVXNlZFEoKTtcblxuY29uc3QgY2hhcnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNoYXJ0XCIpO1xuXG5mdW5jdGlvbiBtb2RlVXBkYXRlZChuZXdNb2RlKSB7XG4gIG1vZGUgPSBuZXdNb2RlO1xuICB1cGRhdGVHcmFwaCgpO1xufVxuXG5mdW5jdGlvbiB2b2x1bWVVcGRhdGVkKG5ld1ZvbHVtZSkge1xuICB2b2x1bWUgPSBuZXdWb2x1bWU7XG4gIHVwZGF0ZUdyYXBoKCk7XG59XG5cbmZ1bmN0aW9uIGFjdGl2aXR5VXBkYXRlZChuZXdBY3Rpdml0eSkge1xuICBhY3Rpdml0eSA9IG5ld0FjdGl2aXR5O1xuICB1cGRhdGVHcmFwaCgpO1xufVxuXG5mdW5jdGlvbiBhaXJpbmdVcGRhdGVkKG5ld0FpcmluZykge1xuICBhaXJpbmcgPSBuZXdBaXJpbmc7XG4gIGNhbGN1bGF0ZVVzZWRRKClcbiAgdXBkYXRlR3JhcGgoKTtcbn1cblxuZnVuY3Rpb24gcGVvcGxlVXBkYXRlZChuZXdQZW9wbGUpIHtcbiAgcGVvcGxlID0gbmV3UGVvcGxlO1xuICBjYWxjdWxhdGVVc2VkUSgpXG4gIHVwZGF0ZUdyYXBoKCk7XG59XG5cbmZ1bmN0aW9uIHZpc3R5cGVVcGRhdGVkKG5ld1Zpc1R5cGUpIHtcbiAgdmlzdHlwZSA9IG5ld1Zpc1R5cGU7XG4gIHVwZGF0ZUdyYXBoKCk7XG59XG5cbi8vIHVzZWRRIHVwZGF0ZWQgYnkgbWFudWFsIHVzZXIgaW5wdXRcbmZ1bmN0aW9uIHVzZWRRVXBkYXRlZChuZXdVc2VkUSkge1xuICB1c2VkUSA9IG5ld1VzZWRRO1xuICB1cGRhdGVHcmFwaCgpO1xufVxuXG4vLyByZWNhbGN1bGF0ZSB1c2VkUSBiYXNlZCBvbiBhaXJpbmcgYW5kIHBlb3BsZVxuZnVuY3Rpb24gY2FsY3VsYXRlVXNlZFEoKSB7XG4gIHVzZWRRID0gZl9RKGFpcmluZykgKiBwZW9wbGU7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidXNlZFFcIikudmFsdWUgPSB1c2VkUVxufVxuXG5mdW5jdGlvbiB1cGRhdGVHcmFwaCgpIHtcbiAgY29uc29sZS5sb2coXCJUaGUgZ3JhcGggbXVzdCBiZSB1cGRhdGVkIVwiKTtcbiAgY29uc29sZS5sb2coYFZvbHVtZTogJHt2b2x1bWV9LCBhY3Rpdml0eTogJHthY3Rpdml0eX0sIGFpcmluZzogJHthaXJpbmd9YCk7XG5cbiAgaWYgKG1vZGUgPT09IFwic2ltcGxlXCIpIHtcbiAgICBkYXRhID0gZGF0YUZTaW1wbGUodm9sdW1lLCBhY3Rpdml0eSwgdXNlZFEsIHBlb3BsZSlcblxuICAgIGRyYXdTaW1wbGVQbG90KGRhdGEpXG4gIH0gZWxzZSBpZiAobW9kZSA9PT0gXCJleHBlcnRcIikge1xuICAgIGRhdGEgPSBkYXRhRih2b2x1bWUsIGFjdGl2aXR5LCBhaXJpbmcsIHBlb3BsZSk7XG5cbiAgICAvLyBpZiAodmlzdHlwZSA9PT0gXCJzdXJmYWNlXCIpIHtcbiAgICAvLyAgIGRyYXdTdXJmYWNlUGxvdChkYXRhKTtcbiAgICAvLyB9IGVsc2Uge1xuICAgIC8vICAgZHJhd0NvbnRvdXJQbG90KGRhdGEpO1xuICAgIC8vIH1cblxuICAgIGRyYXdDb250b3VyUGxvdChkYXRhKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkcmF3U2ltcGxlUGxvdChkYXRhKSB7XG4gIGRhdGFbMF0ubW9kZSA9IFwibGluZXNcIjtcbiAgZGF0YVswXS5uYW1lID0gXCJQSVJBIChpbiAlKVwiXG4gIGRhdGFbMF0ueWF4aXMgPSBcInlcIlxuXG4gIGRhdGFbMV0udHlwZSA9IFwiYmFyXCI7XG4gIGRhdGFbMV0ueWF4aXMgPSBcInkyXCI7XG4gIGRhdGFbMV0ubmFtZSA9IFwiUG90ZW50aWVsbCBBbmdlc3RlY2t0ZVwiXG5cbiAgY29uc29sZS5sb2coZGF0YSlcblxuICB2YXIgbGF5b3V0ID0ge1xuICAgIHNoYXJlWDogdHJ1ZSxcbiAgICB4YXhpczoge1xuICAgICAgICB0aXRsZToge1xuICAgICAgICAgIHRleHQ6IFwiWmVpdCBpbiBTdHVuZGVuXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIHlheGlzOiB7XG4gICAgICB0aXRsZTogJ1BJUkEgKGluICUpJyxcbiAgICAgIG92ZXJsYXlpbmc6ICd5MicsXG4gICAgICB0aWNrdmFsczogWzEwLCAyMCwgMzAsIDQwLCA1MCwgNjAsIDcwLCA4MCwgOTAsIDEwMF0sXG4gICAgICByYW5nZTogWzAsIDEwMF1cbiAgICB9LFxuICAgIHlheGlzMjoge1xuICAgICAgdGlja21vZGU6IFwiYXV0b1wiLFxuICAgICAgdGl0bGU6ICdBbnphaGwgc2ljaCBwb3RlbnRpZWxsIGFuZ2VzdGVja3RlciBQZXJzb25lbiAoZ2VydW5kZXQpJyxcbiAgICAgIHNpZGU6ICdyaWdodCcsXG4gICAgICByYW5nZTogWzAsIHBlb3BsZV1cbiAgICB9LFxuICAgIGxlZ2VuZDoge1xuICAgICAgICB5OiAxLFxuICAgICAgICB4OiAwLFxuICAgICAgfVxuICB9O1xuXG4gIFBsb3RseS5uZXdQbG90KGNoYXJ0RGl2LCBkYXRhLCBsYXlvdXQsIHsgcmVzcG9uc2l2ZTogdHJ1ZSB9KTtcbn1cblxuZnVuY3Rpb24gZHJhd1N1cmZhY2VQbG90KGRhdGEpIHtcbiAgZGF0YS50eXBlID0gXCJzdXJmYWNlXCI7XG4gIGRhdGEuY29udG91cnMgPSB7XG4gICAgejoge1xuICAgICAgc2hvdzogdHJ1ZSxcbiAgICAgIHVzZWNvbG9ybWFwOiB0cnVlLFxuICAgICAgaGlnaGxpZ2h0Y29sb3I6IFwiIzQyZjQ2MlwiLFxuICAgICAgcHJvamVjdDogeyB6OiB0cnVlIH0sXG4gICAgfSxcbiAgfTtcbiAgY29uc3QgbGF5b3V0ID0ge1xuICAgIHhheGlzOiB7XG4gICAgICB0aXRsZToge1xuICAgICAgICB0ZXh0OiBcIlplaXQgaW4gU3R1bmRlblwiLFxuICAgICAgfSxcbiAgICB9LFxuICAgIHlheGlzOiB7XG4gICAgICB0aXRsZToge1xuICAgICAgICB0ZXh0OiBcIlZvbHVtZW5zdHJvbSBpbiBtXjMvaFwiLFxuICAgICAgfSxcbiAgICB9LFxuICB9O1xuXG4gIGNvbnNvbGUubG9nKGRhdGEpO1xuICBQbG90bHkubmV3UGxvdChjaGFydERpdiwgW2RhdGFdLCBsYXlvdXQsIHsgcmVzcG9uc2l2ZTogdHJ1ZSB9KTtcbn1cblxuZnVuY3Rpb24gZHJhd0NvbnRvdXJQbG90KGRhdGEpIHtcbiAgZGF0YS50eXBlID0gXCJjb250b3VyXCI7XG5cbiAgZGF0YS5jb2xvcmJhciA9IHtcbiAgICB0aXRsZTogXCJQSVJBXCIsXG4gICAgdGlja3N1ZmZpeDogXCIlXCIsXG4gIH07XG5cbiAgZGF0YS5ob3ZlcnRlbXBsYXRlID0gXCJQSVJBOiAle3o6LjJmfSU8ZXh0cmE+PC9leHRyYT5cIjtcblxuICBjb25zdCBsYXlvdXQgPSB7XG4gICAgc2hvd2F4ZXNsYWJlbHM6IHRydWUsXG4gICAgeGF4aXNfdGl0bGU6IFwiWmVpdCBpbiBTdHVuZGVuXCIsXG4gICAgeGF4aXM6IHtcbiAgICAgIHRpdGxlOiB7XG4gICAgICAgIHRleHQ6IFwiWmVpdCBpbiBTdHVuZGVuXCIsXG4gICAgICB9LFxuICAgIH0sXG4gICAgeWF4aXM6IHtcbiAgICAgIHRpdGxlOiB7XG4gICAgICAgIHRleHQ6IFwiVm9sdW1lbnN0cm9tIGluIG3Csy9oXCIsXG4gICAgICB9LFxuICAgIH0sXG4gIH07XG5cbiAgY29uc29sZS5sb2coZGF0YSk7XG4gIFBsb3RseS5uZXdQbG90KGNoYXJ0RGl2LCBbZGF0YV0sIGxheW91dCwgeyByZXNwb25zaXZlOiB0cnVlIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgbW9kZVVwZGF0ZWQ6IG1vZGVVcGRhdGVkLFxuICB2b2x1bWVVcGRhdGVkOiB2b2x1bWVVcGRhdGVkLFxuICBhY3Rpdml0eVVwZGF0ZWQ6IGFjdGl2aXR5VXBkYXRlZCxcbiAgYWlyaW5nVXBkYXRlZDogYWlyaW5nVXBkYXRlZCxcbiAgdmlzdHlwZVVwZGF0ZWQ6IHZpc3R5cGVVcGRhdGVkLFxuICBwZW9wbGVVcGRhdGVkOiBwZW9wbGVVcGRhdGVkLFxuICB1c2VkUVVwZGF0ZWQ6IHVzZWRRVXBkYXRlZFxufTtcbiIsImNvbnN0IHZvbHVtZSA9IHJlcXVpcmUoXCIuL3ZvbHVtZS5qc1wiKTtcbmNvbnN0IGdyYXBoID0gcmVxdWlyZShcIi4vZ3JhcGguanNcIik7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kZVwiKS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gIC8vIGlmIGV4cGVydCwgaGlkZSBzaW1wbGUgaHRtbCBlbGVtZW50c1xuICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09IFwiZXhwZXJ0XCIpIHtcbiAgICBzaW1wZWxFbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzaW1wbGVcIilcbiAgICBmb3IgKGVsIG9mIHNpbXBlbEVsZW1lbnRzKSB7XG4gICAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgIH1cbiAgICBleHBlcnRFbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJleHBlcnRcIilcbiAgICBmb3IgKGVsIG9mIGV4cGVydEVsZW1lbnRzKSB7XG4gICAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICB9XG4gIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09IFwic2ltcGxlXCIpIHtcbiAgICBleHBlcnRFbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzaW1wbGVcIilcbiAgICBmb3IgKGVsIG9mIGV4cGVydEVsZW1lbnRzKSB7XG4gICAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICB9XG4gICAgZXhwZXJ0RWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZXhwZXJ0XCIpXG4gICAgZm9yIChlbCBvZiBleHBlcnRFbGVtZW50cykge1xuICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcbiAgICB9XG4gIH1cbiAgZ3JhcGgubW9kZVVwZGF0ZWQoZXZlbnQudGFyZ2V0LnZhbHVlKVxufSk7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWN0aXZpdHlcIikuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uIChldmVudCkge1xuICBncmFwaC5hY3Rpdml0eVVwZGF0ZWQoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbn0pO1xuXG4vLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpc3R5cGVcIikuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uIChldmVudCkge1xuLy8gICBncmFwaC52aXN0eXBlVXBkYXRlZChldmVudC50YXJnZXQudmFsdWUpO1xuLy8gfSk7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGVvcGxlXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICE9IFwiXCIpIHtcbiAgICAgICAgYW1vdW50ID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgICAgICBpZiAoMSA+IGFtb3VudCB8fCBhbW91bnQgPiAxMDApIHtcbiAgICAgICAgICAgIGFtb3VudCA9IDNcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGFtb3VudFxuICAgICAgICB9XG4gICAgICAgIGdyYXBoLnBlb3BsZVVwZGF0ZWQoYW1vdW50KTtcbiAgICB9XG59KTtcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhaXJpbmdcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGdyYXBoLmFpcmluZ1VwZGF0ZWQoZXZlbnQudGFyZ2V0LnZhbHVlKVxufSk7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidXNlZFFcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQudmFsdWUgPCAxKSB7XG4gICAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IDFcbiAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSA+IDMwMDApIHtcbiAgICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gMzAwMFxuICAgIH1cbiAgICBncmFwaC51c2VkUVVwZGF0ZWQoZXZlbnQudGFyZ2V0LnZhbHVlKVxufSk7IiwiY29uc3QgZ3JhcGggPSByZXF1aXJlKFwiLi9ncmFwaC5qc1wiKTtcblxuZnVuY3Rpb24gSW5wdXRFbGVtZW50KGVsZW1lbnQsIGRhdGEpIHtcbiAgdGhpcy5kYXRhID0gZGF0YTtcbiAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgZWxlbWVudC52YWx1ZSA9IGRhdGE7XG4gIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCB0aGlzLCBmYWxzZSk7XG59XG5cbi8qKlxuICogQ2FsbGVkIHdoZW4gdGhlIGlucHV0IGVsZW1lbnQgaXMgdXBkYXRlZCwgZS5nLiwgYnkgdXNpbmcgYXJyb3dzIHdoZW4gdHlwZT1udW1iZXIgb3IgYnkgcHJlc3NpbmcgZW50ZXJcbiAqL1xuSW5wdXRFbGVtZW50LnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICBjYXNlIFwiY2hhbmdlXCI6XG4gICAgICB0aGlzLmNoYW5nZSh0aGlzLmVsZW1lbnQudmFsdWUpO1xuICAgICAgdXBkYXRlVm9sdW1lKCk7XG4gIH1cbn07XG5cbi8qKlxuICogVXBkYXRlIHRoZSBlbGVtZW50OyB0aGlzIG1ldGhvZCB1cGRhdGVzIHRoZSBET00gcmVwcmVzZW50YXRpb24gYW5kIHRoZSBpbnRlcm5hbCByZXByZXNlbnRhdGlvblxuICovXG5JbnB1dEVsZW1lbnQucHJvdG90eXBlLmNoYW5nZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICB0aGlzLmRhdGEgPSB2YWx1ZTtcbiAgdGhpcy5lbGVtZW50LnZhbHVlID0gdmFsdWU7XG59O1xuXG5mdW5jdGlvbiB1cGRhdGVWb2x1bWUoKSB7XG4gIGlmIChsZW5ndGhFbGVtZW50LmRhdGEgPiAxMCkge1xuICAgIGxlbmd0aEVsZW1lbnQuY2hhbmdlKDEwKVxuICB9XG4gIGlmIChsZW5ndGhFbGVtZW50LmRhdGEgPCAxKSB7XG4gICAgbGVuZ3RoRWxlbWVudC5jaGFuZ2UoMSlcbiAgfVxuXG4gIGlmICh3aWR0aEVsZW1lbnQuZGF0YSA+IDEwKSB7XG4gICAgbGVuZ3RoRWxlbWVudC5jaGFuZ2UoMTApXG4gIH1cbiAgaWYgKHdpZHRoRWxlbWVudC5kYXRhIDwgMSkge1xuICAgIGxlbmd0aEVsZW1lbnQuY2hhbmdlKDEpXG4gIH1cblxuICBpZiAoaGVpZ2h0RWxlbWVudC5kYXRhID4gNSkge1xuICAgIGxlbmd0aEVsZW1lbnQuY2hhbmdlKDUpXG4gIH1cbiAgaWYgKGhlaWdodEVsZW1lbnQuZGF0YSA8IDEpIHtcbiAgICBsZW5ndGhFbGVtZW50LmNoYW5nZSgxKVxuICB9XG5cbiAgY29uc3Qgdm9sdW1lID0gbGVuZ3RoRWxlbWVudC5kYXRhICogd2lkdGhFbGVtZW50LmRhdGEgKiBoZWlnaHRFbGVtZW50LmRhdGE7XG4gIGNvbnNvbGUubG9nKHZvbHVtZSk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidm9sdW1lXCIpLnZhbHVlID0gdm9sdW1lO1xuICBncmFwaC52b2x1bWVVcGRhdGVkKHZvbHVtZSk7XG4gIHJldHVybiB2b2x1bWU7XG59XG5cbi8vIGl0IGlzIHBvc3NpYmxlIHRvIHVwZGF0ZSB0aGVzZSBlbGVtZW50cywgZS5nLiwgd2l0aCBsZW5ndGhFbGVtZW50LmNoYW5nZSgxMClcbnZhciBsZW5ndGhFbGVtZW50ID0gbmV3IElucHV0RWxlbWVudChcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsZW5ndGhcIiksXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGVuZ3RoXCIpLnZhbHVlXG4pO1xudmFyIHdpZHRoRWxlbWVudCA9IG5ldyBJbnB1dEVsZW1lbnQoXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkdGhcIiksXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkdGhcIikudmFsdWVcbik7XG52YXIgaGVpZ2h0RWxlbWVudCA9IG5ldyBJbnB1dEVsZW1lbnQoXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVpZ2h0XCIpLFxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlaWdodFwiKS52YWx1ZVxuKTtcbnVwZGF0ZVZvbHVtZSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0OiB1cGRhdGVWb2x1bWUsXG4gIGluaXQ6IHVwZGF0ZVZvbHVtZSxcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9